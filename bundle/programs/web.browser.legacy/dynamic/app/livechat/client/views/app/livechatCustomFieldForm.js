function module(e,t,i){var n,l,a,r,o,u,c,s,m,d,f;i.link("@babel/runtime/regenerator",{default:function(e){n=e}},0),i.link("@babel/runtime/helpers/objectSpread2",{default:function(e){l=e}},1),i.link("meteor/meteor",{Meteor:function(e){a=e}},0),i.link("meteor/reactive-var",{ReactiveVar:function(e){r=e}},1),i.link("meteor/kadira:flow-router",{FlowRouter:function(e){o=e}},2),i.link("meteor/templating",{Template:function(e){u=e}},3),i.link("toastr",{default:function(e){c=e}},4),i.link("../../../../utils",{t:function(e){s=e},handleError:function(e){m=e}},5),i.link("./customTemplates/register",{getCustomFormTemplate:function(e){d=e}},6),i.link("./livechatCustomFieldForm.html"),i.link("../../../../utils/client",{APIClient:function(e){f=e}},7),u.livechatCustomFieldForm.helpers({customField:function(){return u.instance().customField.get()},customFieldsTemplate:function(){return d("livechatCustomFieldsAdditionalForm")},dataContext:function(){return u.instance().localFields}}),u.livechatCustomFieldForm.events({"submit #customField-form":function(e,t){e.preventDefault();var i=t.$("button.save"),n=$(e.currentTarget).data("id"),l=t.$("input[name=field]").val(),r=t.$("input[name=label]").val(),u=t.$("select[name=scope]").val(),d=t.$("select[name=visibility]").val(),f=t.$("input[name=regexp]").val();if(!/^[0-9a-zA-Z-_]+$/.test(l))return c.error(s("error-invalid-custom-field-name"));if(""===r.trim())return c.error(s("Please_fill_a_label"));var v=i.html();i.html(s("Saving"));var F={field:l,label:r,scope:u.trim(),visibility:d.trim(),regexp:f.trim()};t.$(".additional-field").each((function(e,i){var n=t.$(i),l=n.attr("name"),a=n.val();["true","false"].includes(a)&&"SELECT"===i.tagName&&(a="true"===a),F[l]=a})),a.call("livechat:saveCustomField",n,F,(function(e){if(i.html(v),e)return m(e);c.success(s("Saved")),o.go("livechat-customfields")}))},"click button.back":function(e){e.preventDefault(),o.go("livechat-customfields")},"change .custom-field-input":function(e,t){var i,n=e.target,a=n.name,r=n.value;t.localFields.set(l({},t.localFields.get(),((i={})[a]=r,i)))}}),u.livechatCustomFieldForm.onCreated(function(){function e(){var e,t;return n.async(function(){function i(i){for(;;)switch(i.prev=i.next){case 0:return this.customField=new r({}),this.localFields=new r({}),i.next=4,n.awrap(f.v1.get("livechat/custom-fields/"+o.getParam("_id")));case 4:e=i.sent,(t=e.customField)&&(this.customField.set(t),this.localFields.set(l({},t)));case 7:case"end":return i.stop()}}return i}(),null,this,null,Promise)}return e}())}

