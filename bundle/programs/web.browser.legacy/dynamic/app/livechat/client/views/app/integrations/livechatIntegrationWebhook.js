function module(e,t,n){var s,o,i,a,c,r,h,u,l,g,_;n.link("@babel/runtime/regenerator",{default:function(e){s=e}},0),n.link("meteor/meteor",{Meteor:function(e){o=e}},0),n.link("meteor/reactive-var",{ReactiveVar:function(e){i=e}},1),n.link("meteor/templating",{Template:function(e){a=e}},2),n.link("underscore",{default:function(e){c=e}},3),n.link("underscore.string",{default:function(e){r=e}},4),n.link("toastr",{default:function(e){h=e}},5),n.link("../../../../../ui-utils",{modal:function(e){u=e}},6),n.link("../../../../../utils",{t:function(e){l=e},handleError:function(e){g=e}},7),n.link("./livechatIntegrationWebhook.html"),n.link("../../../../../utils/client",{APIClient:function(e){_=e}},8);var v=function(e,t){return e.find((function(e){return e._id===t}))};a.livechatIntegrationWebhook.helpers({webhookUrl:function(){var e=v(a.instance().settings.get(),"Livechat_webhookUrl");return e&&e.value},secretToken:function(){var e=v(a.instance().settings.get(),"Livechat_secret_token");return e&&e.value},disableTest:function(){return a.instance().disableTest.get()},sendOnStartChecked:function(){var e=v(a.instance().settings.get(),"Livechat_webhook_on_start");return e&&e.value},sendOnCloseChecked:function(){var e=v(a.instance().settings.get(),"Livechat_webhook_on_close");return e&&e.value},sendOnChatTakenChecked:function(){var e=v(a.instance().settings.get(),"Livechat_webhook_on_chat_taken");return e&&e.value},sendOnChatQueuedChecked:function(){var e=v(a.instance().settings.get(),"Livechat_webhook_on_chat_queued");return e&&e.value},sendOnForwardChecked:function(){var e=v(a.instance().settings.get(),"Livechat_webhook_on_forward");return e&&e.value},sendOnOfflineChecked:function(){var e=v(a.instance().settings.get(),"Livechat_webhook_on_offline_msg");return e&&e.value},sendOnVisitorMessageChecked:function(){var e=v(a.instance().settings.get(),"Livechat_webhook_on_visitor_message");return e&&e.value},sendOnAgentMessageChecked:function(){var e=v(a.instance().settings.get(),"Livechat_webhook_on_agent_message");return e&&e.value}}),a.livechatIntegrationWebhook.onCreated(function(){function e(){var e=this,t,n;return s.async(function(){function o(o){for(;;)switch(o.prev=o.next){case 0:return this.disableTest=new i(!0),this.settings=new i([]),this.autorun((function(){var t=v(e.settings.get(),"Livechat_webhookUrl");e.disableTest.set(!t||c.isEmpty(t.value))})),o.next=5,s.awrap(_.v1.get("livechat/integrations.settings"));case 5:t=o.sent,n=t.settings,this.settings.set(n);case 8:case"end":return o.stop()}}return o}(),null,this,null,Promise)}return e}()),a.livechatIntegrationWebhook.events({"change #webhookUrl, blur #webhookUrl":function(e,t){var n=v(t.settings.get(),"Livechat_webhookUrl");t.disableTest.set(!n||e.currentTarget.value!==n.value)},"click .test":function(e,t){t.disableTest.get()||o.call("livechat:webhookTest",(function(e){if(e)return g(e);u.open({title:l("It_works"),type:"success",timer:2e3})}))},"click .reset-settings":function(e,t){e.preventDefault();var n=v(t.settings.get(),"Livechat_webhookUrl"),s=v(t.settings.get(),"Livechat_secret_token"),o=v(t.settings.get(),"Livechat_webhook_on_start"),i=v(t.settings.get(),"Livechat_webhook_on_close"),a=v(t.settings.get(),"Livechat_webhook_on_chat_taken"),r=v(t.settings.get(),"Livechat_webhook_on_chat_queued"),h=v(t.settings.get(),"Livechat_webhook_on_forward"),u=v(t.settings.get(),"Livechat_webhook_on_offline_msg"),l=v(t.settings.get(),"Livechat_webhook_on_visitor_message"),g=v(t.settings.get(),"Livechat_webhook_on_agent_message");t.$("#webhookUrl").val(n&&n.value),t.$("#secretToken").val(s&&s.value),t.$("#sendOnStart").get(0).checked=o&&o.value,t.$("#sendOnClose").get(0).checked=i&&i.value,t.$("#sendOnChatTaken").get(0).checked=a&&a.value,t.$("#sendOnChatQueued").get(0).checked=r&&r.value,t.$("#sendOnForward").get(0).checked=h&&h.value,t.$("#sendOnOffline").get(0).checked=u&&u.value,t.$("#sendOnVisitorMessage").get(0).checked=l&&l.value,t.$("#sendOnAgentMessage").get(0).checked=g&&g.value,t.disableTest.set(!n||c.isEmpty(n.value))},"submit .rocket-form":function(e,t){e.preventDefault();var n={Livechat_webhookUrl:r.trim(t.$("#webhookUrl").val()),Livechat_secret_token:r.trim(t.$("#secretToken").val()),Livechat_webhook_on_start:t.$("#sendOnStart").get(0).checked,Livechat_webhook_on_close:t.$("#sendOnClose").get(0).checked,Livechat_webhook_on_chat_taken:t.$("#sendOnChatTaken").get(0).checked,Livechat_webhook_on_chat_queued:t.$("#sendOnChatQueued").get(0).checked,Livechat_webhook_on_forward:t.$("#sendOnForward").get(0).checked,Livechat_webhook_on_offline_msg:t.$("#sendOnOffline").get(0).checked,Livechat_webhook_on_visitor_message:t.$("#sendOnVisitorMessage").get(0).checked,Livechat_webhook_on_agent_message:t.$("#sendOnAgentMessage").get(0).checked};o.call("livechat:saveIntegration",n,(function(e){if(e)return g(e);var s=t.settings.get().map((function(e){return e.value=n[e._id],e}));t.settings.set(s),h.success(l("Saved"))}))}})}

