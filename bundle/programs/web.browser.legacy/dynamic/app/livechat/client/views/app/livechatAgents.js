function module(e,t,n){var r,a,i,s,c,o,u,l,f,g,v,d,h,m,p;n.link("@babel/runtime/helpers/toConsumableArray",{default:function(e){r=e}},0),n.link("@babel/runtime/regenerator",{default:function(e){a=e}},1),n.link("meteor/meteor",{Meteor:function(e){i=e}},0),n.link("meteor/templating",{Template:function(e){s=e}},1),n.link("meteor/kadira:flow-router",{FlowRouter:function(e){c=e}},2),n.link("meteor/reactive-var",{ReactiveVar:function(e){o=e}},3),n.link("meteor/reactive-dict",{ReactiveDict:function(e){u=e}},4),n.link("underscore",{default:function(e){l=e}},5),n.link("../../../../ui-utils",{modal:function(e){f=e},call:function(e){g=e},TabBar:function(e){v=e},RocketChatTabBar:function(e){d=e}},6),n.link("../../../../utils/client",{t:function(e){h=e},handleError:function(e){m=e},APIClient:function(e){p=e}},7),n.link("./livechatAgents.html");var A=function(){function e(e){var t,n,r,i,s,c=arguments;return a.async(function(){function o(o){for(;;)switch(o.prev=o.next){case 0:return t=c.length>1&&void 0!==c[1]?c[1]:50,n=c.length>2?c[2]:void 0,r="livechat/users/agent?count="+t,n&&(r+="&text="+encodeURIComponent(n)),o.next=6,a.awrap(p.v1.get(r));case 6:i=o.sent,s=i.users,e.agents.set(s),e.ready.set(!0);case 10:case"end":return o.stop()}}return o}(),null,null,null,Promise)}return e}(),b=function(e){return e.username};s.livechatAgents.helpers({exceptionsAgents:function(){var e,t=s.instance().selectedAgents;return s.instance().agents.get().map(b).concat(t.get().map(b))},deleteLastAgent:function(){var e=s.instance();return function(){var t=e.selectedAgents.curValue;t.pop(),e.selectedAgents.set(t)}},isLoading:function(){return s.instance().state.get("loading")},agents:function(){return s.instance().agents.get()},emailAddress:function(){if(this.emails&&this.emails.length>0)return this.emails[0].address},agentModifier:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e.get();return"@"+(0===n.length?t:t.replace(new RegExp(e.get()),(function(e){return"<strong>"+e+"</strong>"})))}},onSelectAgents:function(){return s.instance().onSelectAgents},selectedAgents:function(){return s.instance().selectedAgents.get()},onClickTagAgents:function(){return s.instance().onClickTagAgents},isReady:function(){var e=s.instance();return e.ready&&e.ready.get()},onTableScroll:function(){var e=s.instance();return function(t){if(t.offsetHeight+t.scrollTop>=t.scrollHeight-100)return e.limit.set(e.limit.get()+50)}},flexData:function(){return{tabBar:s.instance().tabBar,data:s.instance().tabBarData.get()}},statusService:function(){var e=this.status,t=this.statusLivechat;return h("available"===t&&"offline"!==e?"Available":"Unavailable")}});var w=300;s.livechatAgents.events({"click .remove-agent":function(e,t){var n=this;e.preventDefault(),f.open({title:h("Are_you_sure"),type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:h("Yes"),cancelButtonText:h("Cancel"),closeOnConfirm:!1,html:!1},(function(){i.call("livechat:removeAgent",n.username,function(){function e(e){return a.async(function(){function n(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=2;break}return n.abrupt("return",m(e));case 2:return"opened"===t.tabBar.getState()&&t.tabBar.close(),n.next=5,a.awrap(A(t));case 5:f.open({title:h("Removed"),text:h("Agent_removed"),type:"success",timer:1e3,showConfirmButton:!1});case 6:case"end":return n.stop()}}return n}(),null,null,null,Promise)}return e}())}))},"submit #form-agent":function(){function e(e,t){var n,r,i,s,c;return a.async(function(){function o(o){for(;;)switch(o.prev=o.next){case 0:if(e.preventDefault(),n=t.selectedAgents,r=t.state,i=t.limit,s=t.filter,(c=n.get()).length){o.next=5;break}return o.abrupt("return");case 5:return r.set("loading",!0),o.prev=6,o.next=9,a.awrap(Promise.all(c.map((function(e){var t=e.username;return g("livechat:addAgent",t)}))));case 9:return o.next=11,a.awrap(A(t,i.get(),s.get()));case 11:n.set([]);case 12:return o.prev=12,r.set("loading",!1),o.finish(12);case 15:case"end":return o.stop()}}return o}(),null,null,[[6,,12,15]],Promise)}return e}(),"keydown #agents-filter":function(e){13===e.which&&(e.stopPropagation(),e.preventDefault())},"keyup #agents-filter":l.debounce((function(e,t){e.preventDefault(),t.filter.set(e.currentTarget.value)}),300),"click .user-info":function(e,t){e.preventDefault(),t.tabBarData.set({agentId:this._id,onRemoveAgent:function(){return A(t)}}),t.tabBar.setData({label:h("Agent_Info"),icon:"livechat"}),t.tabBar.open("livechat-agent-info")}}),s.livechatAgents.onCreated((function(){var e=this,t=this;this.limit=new o(50),this.filter=new o(""),this.state=new u({loading:!1}),this.ready=new o(!0),this.selectedAgents=new o([]),this.agents=new o([]),this.tabBar=new d,this.tabBar.showGroup(c.current().route.name),this.tabBarData=new o,v.addButton({groups:["livechat-agent-users"],id:"livechat-agent-info",i18nTitle:"Agent_Info",icon:"livechat",template:"agentInfo",order:1}),this.onSelectAgents=function(t){var n=t.item;e.selectedAgents.set([].concat(r(e.selectedAgents.curValue),[n]))},this.onClickTagAgents=function(t){var n=t.username;e.selectedAgents.set(e.selectedAgents.curValue.filter((function(e){return e.username!==n})))},this.autorun((function(){var e=t.limit.get(),n=t.filter.get();A(t,e,n)}))}))}

