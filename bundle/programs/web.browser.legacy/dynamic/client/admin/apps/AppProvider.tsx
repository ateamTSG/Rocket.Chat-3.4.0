function module(e,n,t){var r,a,u,i,o,c,s,l,f,p,d,v,m;t.link("@babel/runtime/helpers/toConsumableArray",{default:function(e){r=e}},0),t.link("@babel/runtime/regenerator",{default:function(e){a=e}},1),t.link("@babel/runtime/helpers/objectSpread2",{default:function(e){u=e}},2),t.link("@babel/runtime/helpers/createForOfIteratorHelperLoose",{default:function(e){i=e}},3),t.link("@babel/runtime/helpers/slicedToArray",{default:function(e){o=e}},4),t.export({AppDataContext:function(){return A}}),t.link("react",{default:function(e){c=e},createContext:function(e){s=e},useEffect:function(e){l=e},useRef:function(e){f=e},useState:function(e){p=e}},0),t.link("../../../app/apps/client/orchestrator",{Apps:function(e){d=e}},1),t.link("../../../app/apps/client/communication",{AppEvents:function(e){v=e}},2),t.link("./helpers",{handleAPIError:function(e){m=e}},3);var A=s({data:[],dataCache:[]}),b=function(e){for(var n=Object.entries(e),t=0,r=n;t<r.length;t++){var a,u=r[t],c=o(u,2),s=c[0],l=c[1];null===(a=d.getWsListener())||void 0===a||a.registerListener(v[s],l)}return function(){for(var e=i(n),t;!(t=e()).done;){var r,a=t.value,u=o(a,2),c=u[0],s=u[1];null===(r=d.getWsListener())||void 0===r||r.unregisterListener(v[c],s)}}},k=function(e){var n=e.children,t=p((function(){return[]})),i=o(t,2),s=i[0],v=i[1],k=p((function(){return[]})),h=o(k,2),P=h[0],x=h[1],g=f(s);g.current=s;var E=function(){x((function(){return[]}))},I=function(){return g.current.slice(0)};return l((function(){var e=function(){function e(e){var n,t,r,i,o,c;return a.async(function(){function s(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,a.awrap(d.getApp(e));case 3:return n=s.sent,t=n.status,r=n.version,s.next=8,a.awrap(d.getAppFromMarketplace(e,r));case 8:i=s.sent,o=I(),c=o.findIndex((function(n){var t;return n.id===e})),o[c]=u({},i,{installed:!0,status:t,version:r,marketplaceVersion:i.version}),v(o),E(),s.next=19;break;case 16:s.prev=16,s.t0=s.catch(0),m(s.t0);case 19:case"end":return s.stop()}}return s}(),null,null,[[0,16]],Promise)}return e}(),n,t=b({APP_ADDED:e,APP_UPDATED:e,APP_REMOVED:function(e){var n=I(),t=n.findIndex((function(n){var t;return n.id===e}));n[t]&&(!1!==n[t].marketplace?n.splice(t,1):(delete n[t].installed,delete n[t].status,n[t].version=n[t].marketplaceVersion),v(n),E())},APP_STATUS_CHANGE:function(e){var n=e.appId,t=e.status,r=I(),a=r.find((function(e){var t;return e.id===n}));a&&(a.status=t,v(r),E())},APP_SETTING_UPDATED:function(){E()}});return function(){function e(){var e,n,i,c,s;return a.async(function(){function l(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,a.awrap(Promise.all([d.getAppsFromMarketplace(),d.getApps()]));case 3:e=l.sent,n=o(e,2),i=n[0],c=n[1],s=i.map((function(e){var n=c.findIndex((function(n){var t;return n.id===e.id}));if(!c[n])return u({},e,{status:void 0,marketplaceVersion:e.version,bundledIn:e.bundledIn});var t=c.splice(n,1).pop();return u({},e,{installed:!0,status:null==t?void 0:t.status,version:null==t?void 0:t.version,bundledIn:e.bundledIn,marketplaceVersion:e.version})})),c.length&&s.push.apply(s,r(c.map((function(e){return u({},e,{installed:!0,marketplace:!1})})))),v(s.sort((function(e,n){return e.name.toLowerCase()>n.name.toLowerCase()?1:-1}))),E(),l.next=17;break;case 13:l.prev=13,l.t0=l.catch(0),m(l.t0),t();case 17:case"end":return l.stop()}}return l}(),null,null,[[0,13]],Promise)}return e}()(),t}),[]),c.createElement(A.Provider,{children:n,value:{data:s,dataCache:P}})};t.exportDefault(k)}

