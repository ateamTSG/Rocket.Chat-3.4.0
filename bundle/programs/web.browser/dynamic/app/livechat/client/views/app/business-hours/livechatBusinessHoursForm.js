function module(e,t,s){let a,r,n,i,o,u,c,m,l,d,h,y,H;s.link("@babel/runtime/helpers/objectSpread2",{default(e){a=e}},0),s.link("meteor/meteor",{Meteor(e){r=e}},0),s.link("meteor/reactive-var",{ReactiveVar(e){n=e}},1),s.link("meteor/templating",{Template(e){i=e}},2),s.link("meteor/rocketchat:tap-i18n",{TAPi18n(e){o=e}},3),s.link("meteor/kadira:flow-router",{FlowRouter(e){u=e}},4),s.link("toastr",{default(e){c=e}},5),s.link("moment",{default(e){m=e}},6),s.link("../../../../../utils/client",{t(e){l=e},handleError(e){d=e},APIClient(e){h=e}},7),s.link("./livechatBusinessHoursForm.html"),s.link("../customTemplates/register",{getCustomFormTemplate(e){y=e}},8),s.link("./BusinessHours",{businessHourManager(e){H=e}},9),i.livechatBusinessHoursForm.helpers({days:()=>i.instance().businessHour.get().workHours,startName:e=>"".concat(e.day,"_start"),finishName:e=>"".concat(e.day,"_finish"),openName:e=>"".concat(e.day,"_open"),start:e=>i.instance().dayVars[e.day].start.get(),finish:e=>i.instance().dayVars[e.day].finish.get(),name:e=>o.__(e.day),open:e=>i.instance().dayVars[e.day].open.get(),customFieldsTemplate(){if(H.showCustomTemplate(i.instance().businessHour.get()))return y("livechatBusinessHoursForm")},timezoneTemplate(){if(H.showTimezoneTemplate())return y("livechatBusinessHoursTimezoneForm")},showBackButton:()=>H.showBackButton(),data:()=>i.instance().businessHour});const g=e=>e.split("_");i.livechatBusinessHoursForm.events({"change .preview-settings, keydown .preview-settings"(e,t){const[s,a]=g(e.currentTarget.name),r=m(e.currentTarget.value,"HH:mm");"start"===a?r.isSameOrBefore(m(t.dayVars[s].finish.get(),"HH:mm"))?t.dayVars[s].start.set(e.currentTarget.value):e.currentTarget.value=t.dayVars[s].start.get():"finish"===a&&(r.isSameOrAfter(m(t.dayVars[s].start.get(),"HH:mm"))?t.dayVars[s].finish.set(e.currentTarget.value):e.currentTarget.value=t.dayVars[s].finish.get())},"change .dayOpenCheck input"(e,t){const[s,a]=g(e.currentTarget.name);t.dayVars[s][a].set(e.target.checked)},"change .preview-settings, keyup .preview-settings"(e,t){let{value:s}=e.currentTarget;"radio"===e.currentTarget.type&&(s="true"===s,t[e.currentTarget.name].set(s))},"click button.back"(e){e.preventDefault(),u.go("livechat-business-hours")},"submit .rocket-form"(e,t){e.preventDefault();const s=[];for(const a in t.dayVars)if(t.dayVars.hasOwnProperty(a)){const e=t.dayVars[a],r=m(e.start.get(),"HH:mm").format("HH:mm"),n=m(e.finish.get(),"HH:mm").format("HH:mm");s.push({day:a,start:r,finish:n,open:e.open.get()})}const n=a({},t.businessHour.get(),{workHours:s});t.$(".customFormField").each((e,s)=>{const a=t.$(s),r=a.attr("name");n[r]=a.val()}),r.call("livechat:saveBusinessHour",n,(function(e){if(e)return d(e);c.success(l("Business_hours_updated")),u.go("livechat-business-hours")}))}});const p=()=>{const e=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],t=["Saturday","Sunday"];return{workHours:e.map(e=>({day:e,start:"00:00",finish:"00:00",open:!t.includes(e)}))}};i.livechatBusinessHoursForm.onCreated((async function(){this.dayVars=p().workHours.reduce((e,t)=>(e[t.day]={start:new n(t.start),finish:new n(t.finish),open:new n(t.open)},e),{}),this.businessHour=new n({}),this.businessHour.set(a({},p())),this.autorun(async()=>{if(u.current().route.name.includes("new"))return;const e=u.getParam("_id"),t=u.getParam("type");let s="livechat/business-hour";e&&t&&(s+="?_id=".concat(e,"&type=").concat(t));const{businessHour:a}=await h.v1.get(s);a&&(this.businessHour.set(a),a.workHours.forEach(e=>{this.dayVars[e.day].start.set(m.utc(e.start.utc.time,"HH:mm").tz(a.timezone.name).format("HH:mm")),this.dayVars[e.day].finish.set(m.utc(e.finish.utc.time,"HH:mm").tz(a.timezone.name).format("HH:mm")),this.dayVars[e.day].open.set(e.open)}))})}))}

