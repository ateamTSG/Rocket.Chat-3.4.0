function module(e,t,l){let i,a,s,o,n,r,c,m,u,d;l.link("@babel/runtime/helpers/objectSpread2",{default(e){i=e}},0),l.link("meteor/meteor",{Meteor(e){a=e}},0),l.link("meteor/reactive-var",{ReactiveVar(e){s=e}},1),l.link("meteor/kadira:flow-router",{FlowRouter(e){o=e}},2),l.link("meteor/templating",{Template(e){n=e}},3),l.link("toastr",{default(e){r=e}},4),l.link("../../../../utils",{t(e){c=e},handleError(e){m=e}},5),l.link("./customTemplates/register",{getCustomFormTemplate(e){u=e}},6),l.link("./livechatCustomFieldForm.html"),l.link("../../../../utils/client",{APIClient(e){d=e}},7),n.livechatCustomFieldForm.helpers({customField:()=>n.instance().customField.get(),customFieldsTemplate:()=>u("livechatCustomFieldsAdditionalForm"),dataContext:()=>n.instance().localFields}),n.livechatCustomFieldForm.events({"submit #customField-form"(e,t){e.preventDefault();const l=t.$("button.save"),i=$(e.currentTarget).data("id"),s=t.$("input[name=field]").val(),n=t.$("input[name=label]").val(),u=t.$("select[name=scope]").val(),d=t.$("select[name=visibility]").val(),v=t.$("input[name=regexp]").val();if(!/^[0-9a-zA-Z-_]+$/.test(s))return r.error(c("error-invalid-custom-field-name"));if(""===n.trim())return r.error(c("Please_fill_a_label"));const F=l.html();l.html(c("Saving"));const f={field:s,label:n,scope:u.trim(),visibility:d.trim(),regexp:v.trim()};t.$(".additional-field").each((e,l)=>{const i=t.$(l),a=i.attr("name");let s=i.val();["true","false"].includes(s)&&"SELECT"===l.tagName&&(s="true"===s),f[a]=s}),a.call("livechat:saveCustomField",i,f,(function(e){if(l.html(F),e)return m(e);r.success(c("Saved")),o.go("livechat-customfields")}))},"click button.back"(e){e.preventDefault(),o.go("livechat-customfields")},"change .custom-field-input"(e,t){const{target:{name:l,value:a}}=e;t.localFields.set(i({},t.localFields.get(),{[l]:a}))}}),n.livechatCustomFieldForm.onCreated((async function(){this.customField=new s({}),this.localFields=new s({});const{customField:e}=await d.v1.get("livechat/custom-fields/".concat(o.getParam("_id")));e&&(this.customField.set(e),this.localFields.set(i({},e)))}))}

